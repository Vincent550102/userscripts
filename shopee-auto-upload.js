// ==UserScript==
// @name         shopee 追蹤碼上傳
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  自動上傳追蹤碼到 shopee 內部系統
// @author       Vincent55
// @match        https://sp.spx.shopee.tw/inbound-management*
// @grant        none
// ==/UserScript==

const _0x5cd927=_0x58b2;(function(_0x4229cd,_0x4464ab){const _0x135f7f=_0x58b2,_0x24e3f1=_0x4229cd();while(!![]){try{const _0xdce03c=-parseInt(_0x135f7f(0x1fe))/0x1+parseInt(_0x135f7f(0x1ae))/0x2+-parseInt(_0x135f7f(0x1e7))/0x3+parseInt(_0x135f7f(0x1ed))/0x4*(-parseInt(_0x135f7f(0x1e8))/0x5)+parseInt(_0x135f7f(0x1ad))/0x6*(-parseInt(_0x135f7f(0x1da))/0x7)+-parseInt(_0x135f7f(0x1b3))/0x8+parseInt(_0x135f7f(0x1b5))/0x9;if(_0xdce03c===_0x4464ab)break;else _0x24e3f1['push'](_0x24e3f1['shift']());}catch(_0x3d3b73){_0x24e3f1['push'](_0x24e3f1['shift']());}}}(_0x508f,0xe7a62));const urls={'addCheck':'https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add_check','add':'https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add','createTask':'https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create','checkListNum':_0x5cd927(0x1dd),'taskComplete':'https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/complete','createCheck':_0x5cd927(0x1d8),'userName':_0x5cd927(0x1d5)};async function putFrontToPage(){const _0x411076=_0x5cd927;var _0x27e874=document[_0x411076(0x1f3)](_0x411076(0x1be));_0x27e874['style'][_0x411076(0x1c5)]=_0x411076(0x1df),_0x27e874[_0x411076(0x1cb)][_0x411076(0x1aa)]='0',_0x27e874['style'][_0x411076(0x1c2)]='0',_0x27e874['style'][_0x411076(0x1b6)]=_0x411076(0x1e5),_0x27e874[_0x411076(0x1cb)][_0x411076(0x1d2)]=_0x411076(0x1f9),_0x27e874[_0x411076(0x1cb)][_0x411076(0x1ec)]='2px\x20solid\x20#ccc',_0x27e874[_0x411076(0x1cb)][_0x411076(0x1fa)]=_0x411076(0x1eb),_0x27e874[_0x411076(0x1cb)][_0x411076(0x1db)]=_0x411076(0x1de),_0x27e874['style'][_0x411076(0x1ca)]=_0x411076(0x1f5);var _0x391931=document['createElement'](_0x411076(0x1b2));_0x391931[_0x411076(0x1bc)]='輸入追蹤碼（以換行隔開）',_0x391931['id']=_0x411076(0x1a9),_0x391931[_0x411076(0x1cb)][_0x411076(0x1b6)]=_0x411076(0x1b0),_0x391931[_0x411076(0x1cb)][_0x411076(0x1cf)]=_0x411076(0x1ee),_0x391931['style'][_0x411076(0x1ea)]=_0x411076(0x1eb);var _0x1a3fea=document[_0x411076(0x1f3)]('button');_0x1a3fea[_0x411076(0x1e2)]=_0x411076(0x1f0),_0x1a3fea[_0x411076(0x1c6)]=function(){startUpload();};var _0x1b5c41=document[_0x411076(0x1f3)]('button');_0x1b5c41[_0x411076(0x1e2)]=_0x411076(0x1e1),_0x1b5c41['onclick']=function(){const _0x112a1f=_0x411076;_0x2abcc3[_0x112a1f(0x1f7)]='';};var _0x2abcc3=document[_0x411076(0x1f3)](_0x411076(0x1b2));_0x2abcc3['id']='logDisplay',_0x2abcc3['style'][_0x411076(0x1b6)]=_0x411076(0x1e5),_0x2abcc3[_0x411076(0x1cb)][_0x411076(0x1cf)]=_0x411076(0x1d3),_0x2abcc3[_0x411076(0x1cb)][_0x411076(0x1fc)]=_0x411076(0x1eb),_0x2abcc3[_0x411076(0x1b9)]=!![],_0x27e874[_0x411076(0x1f8)](_0x391931),_0x27e874[_0x411076(0x1f8)](_0x1a3fea),_0x27e874[_0x411076(0x1f8)](_0x1b5c41),_0x27e874[_0x411076(0x1f8)](_0x2abcc3),document[_0x411076(0x1e6)][_0x411076(0x1b7)](_0x27e874,document[_0x411076(0x1e6)][_0x411076(0x1c7)]),document[_0x411076(0x1e6)][_0x411076(0x1cb)][_0x411076(0x1ba)]=_0x27e874['offsetHeight']+'px';}async function addLogEntry(_0x26303b){const _0x2deec8=_0x5cd927;logDisplay[_0x2deec8(0x1f7)]+=_0x26303b+'\x0a',scrollToBottom();}async function handleTaskComplete(_0x5f38a9,_0xf84e3a=![]){const _0x47a5bc=_0x5cd927,_0x207a72=await fetch(urls[_0x47a5bc(0x1f6)],{'method':_0x47a5bc(0x1ce),'headers':{'Content-Type':_0x47a5bc(0x1d7)},'body':JSON['stringify']({'receive_task_id':_0x5f38a9,'operation_info':{'operation_mode':0x2,'operation_device':0x1}})});if(_0xf84e3a)return await createTask();}async function getUserName(){const _0x4a5313=_0x5cd927,_0x10a9c8=await fetch(urls['userName'],{'method':'GET','headers':{'Content-Type':_0x4a5313(0x1d7)}}),_0x39ad70=await _0x10a9c8[_0x4a5313(0x1b4)]();return _0x39ad70[_0x4a5313(0x1ff)][_0x4a5313(0x1bf)];}async function uploadSuccessNum(_0x235cb7){const _0x24258c=_0x5cd927,_0x5b2da4=new URLSearchParams(window[_0x24258c(0x1e4)][_0x24258c(0x1f4)]),_0x14d6b4=_0x5b2da4[_0x24258c(0x1c0)](_0x24258c(0x1c1));if(!_0x14d6b4){alert(_0x24258c(0x1c3));return;}const _0x51ec2f=new FormData(),_0x46596e=await getUserName();_0x51ec2f['append'](_0x24258c(0x1bd),_0x14d6b4),_0x51ec2f[_0x24258c(0x1d6)](_0x24258c(0x1c4),_0x235cb7),_0x51ec2f[_0x24258c(0x1d6)](_0x24258c(0x1a8),_0x46596e),console[_0x24258c(0x1fd)](_0x24258c(0x1c8),_0x46596e);const _0x26cc02=await fetch(_0x24258c(0x1a6),{'method':'POST','body':_0x51ec2f}),_0x4e228d=await _0x26cc02['json']();return _0x4e228d['Status'];}function _0x58b2(_0x22befa,_0x587fc1){const _0x508fb6=_0x508f();return _0x58b2=function(_0x58b244,_0x4c5d84){_0x58b244=_0x58b244-0x1a6;let _0x38b7b4=_0x508fb6[_0x58b244];return _0x38b7b4;},_0x58b2(_0x22befa,_0x587fc1);}async function startUpload(){const _0x159ec5=_0x5cd927;var _0x3a203c=await getTaskId();!_0x3a203c&&(_0x3a203c=await createTask());var _0x378890=await getListNum(_0x3a203c),_0x4d4eb8=0x0;console[_0x159ec5(0x1fd)](_0x3a203c,_0x378890);const _0x8378b5=inputBox['value'][_0x159ec5(0x1e3)]()[_0x159ec5(0x1b8)]('\x0a');for(const _0x17e80d of _0x8378b5){console[_0x159ec5(0x1fd)](_0x17e80d,_0x378890);_0x378890>=0x1c2&&(_0x3a203c=await handleTaskComplete(_0x3a203c,!![]),await addLogEntry('數量達\x20450\x20開啟新的任務:\x20'+_0x3a203c),_0x378890=0x0);const _0x196a70=await fetch(urls[_0x159ec5(0x1ac)],{'method':_0x159ec5(0x1ce),'headers':{'Content-Type':_0x159ec5(0x1d7)},'body':JSON[_0x159ec5(0x1dc)]({'order_id':_0x17e80d,'receive_task_id':_0x3a203c,'operation_info':{'operation_device':0x1,'operation_mode':0x2}})}),_0x2f5dbc=await _0x196a70[_0x159ec5(0x1b4)]();await addLogEntry(_0x17e80d+'\x20|\x20'+_0x2f5dbc[_0x159ec5(0x1af)]),_0x2f5dbc['retcode']==0x0&&(_0x378890++,_0x4d4eb8++);}await addLogEntry('共\x20'+_0x8378b5[_0x159ec5(0x1e9)]+'\x20件|\x20成功上傳\x20'+_0x4d4eb8+'\x20件'),await handleTaskComplete(_0x3a203c);const _0x3e8c69=await uploadSuccessNum(_0x4d4eb8);await addLogEntry(_0x159ec5(0x1ef)+_0x3e8c69);}function scrollToBottom(){const _0x321333=_0x5cd927;logDisplay['scrollTop']=logDisplay[_0x321333(0x1d1)];}async function getTaskId(){const _0x5dce64=_0x5cd927,_0x2cb523=await fetch(urls[_0x5dce64(0x1d0)],{'method':_0x5dce64(0x1fb),'headers':{'Content-Type':_0x5dce64(0x1d7)}}),_0x21a81a=await _0x2cb523[_0x5dce64(0x1b4)]();return _0x21a81a['data']['existed_task_id'];}async function createTask(){const _0x1a16cf=_0x5cd927,_0x3ce591=await fetch(urls[_0x1a16cf(0x1b1)],{'method':'POST','headers':{'Content-Type':_0x1a16cf(0x1d7)},'body':JSON[_0x1a16cf(0x1dc)]({})}),_0x28a7e7=await _0x3ce591[_0x1a16cf(0x1b4)]();return _0x28a7e7[_0x1a16cf(0x1ff)]['task_id'];}async function getListNum(_0x25a7bc){const _0x4f349b=_0x5cd927,_0x48dcd0=await fetch(urls[_0x4f349b(0x1e0)]+'?'+new URLSearchParams({'receive_task_id':_0x25a7bc})),_0x1b7f0f=await _0x48dcd0[_0x4f349b(0x1b4)]();return _0x1b7f0f[_0x4f349b(0x1ff)][_0x4f349b(0x1f1)];}function xorStrings(_0x23d466,_0x52ff34){const _0x43ef57=_0x5cd927;let _0x5e257c='',_0x342e7c=Math[_0x43ef57(0x1bb)](_0x23d466[_0x43ef57(0x1e9)],_0x52ff34[_0x43ef57(0x1e9)]);for(let _0x48dfaf=0x0;_0x48dfaf<_0x342e7c;_0x48dfaf++){let _0x12c865=_0x23d466[_0x43ef57(0x1d4)](_0x48dfaf%_0x23d466[_0x43ef57(0x1e9)]),_0x39e4e7=_0x52ff34[_0x43ef57(0x1d4)](_0x48dfaf%_0x52ff34[_0x43ef57(0x1e9)]);_0x5e257c+=String[_0x43ef57(0x1cc)](_0x12c865^_0x39e4e7);}return btoa(_0x5e257c);}(async function(){'use strict';const _0x5d5864=_0x5cd927;const _0x19cf43=new URLSearchParams(window[_0x5d5864(0x1e4)]['search']),_0x5dd8a3=_0x19cf43['get'](_0x5d5864(0x1c1));if(!_0x5dd8a3){alert(_0x5d5864(0x1c3));return;}console['log'](_0x5d5864(0x1cd)+_0x5dd8a3);const _0x2f944e=_0x5d5864(0x1d9),_0x55a46e=await fetch(_0x2f944e+_0x5dd8a3),_0x711962=await _0x55a46e[_0x5d5864(0x1ab)]();if(!_0x711962[_0x5d5864(0x1c9)](_0x5d5864(0x1a7)))await putFrontToPage(_0x5dd8a3);else alert(_0x5d5864(0x1f2));}());function _0x508f(){const _0x529a07=['2994bSvPWE','3163334KtrDZy','message','80%','createTask','textarea','8149248YuriLi','json','38273661oRNaHh','width','insertBefore','split','readOnly','paddingTop','max','placeholder','Token','div','current_point_name','get','token','left','token\x20未給予','Qty','position','onclick','firstChild','firm:\x20','includes','zIndex','style','fromCharCode','Name:\x20','POST','height','createCheck','scrollHeight','backgroundColor','100px','charCodeAt','https://sp.spx.shopee.tw/sp-api/current_user','append','application/json','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create_check','https://dev.orglife.com.tw/Api/DB?Type=Token&App=ShopeeUpload&Token=','15148nvwdog','boxShadow','stringify','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/list','0\x202px\x205px\x20rgba(0,0,0,0.2)','fixed','checkListNum','清空紀錄','textContent','trim','location','100%','body','1483089SFVlGe','4646645gYGKaW','length','marginRight','10px','borderBottom','4aqWpDL','50px','回傳數量狀態:\x20','開始上傳','total','token\x20錯誤','createElement','search','1000','taskComplete','value','appendChild','#f8f8f8','padding','GET','marginTop','log','1363278kYUEvO','data','https://dev.orglife.com.tw/Api/DB?Type=Shopee_Upd','Invalid','Firm','inputBox','top','text','add'];_0x508f=function(){return _0x529a07;};return _0x508f();}