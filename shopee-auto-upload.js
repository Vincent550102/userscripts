// ==UserScript==
// @name         shopee 追蹤碼上傳
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  自動上傳追蹤碼到 shopee 內部系統
// @author       Vincent55
// @match        https://sp.spx.shopee.tw/inbound-management*
// @grant        none
// ==/UserScript==

function _0x1abb(_0x3892fd,_0x171a36){const _0x82a789=_0x82a7();return _0x1abb=function(_0x1abb13,_0x2d956f){_0x1abb13=_0x1abb13-0x150;let _0x13c6ad=_0x82a789[_0x1abb13];return _0x13c6ad;},_0x1abb(_0x3892fd,_0x171a36);}const _0x5504be=_0x1abb;(function(_0x29dd19,_0x2f3dec){const _0x12db60=_0x1abb,_0x20953a=_0x29dd19();while(!![]){try{const _0x28a914=parseInt(_0x12db60(0x189))/0x1*(parseInt(_0x12db60(0x190))/0x2)+parseInt(_0x12db60(0x185))/0x3+parseInt(_0x12db60(0x16e))/0x4*(-parseInt(_0x12db60(0x15f))/0x5)+-parseInt(_0x12db60(0x173))/0x6+parseInt(_0x12db60(0x18b))/0x7+-parseInt(_0x12db60(0x17b))/0x8*(-parseInt(_0x12db60(0x175))/0x9)+-parseInt(_0x12db60(0x174))/0xa;if(_0x28a914===_0x2f3dec)break;else _0x20953a['push'](_0x20953a['shift']());}catch(_0x578a94){_0x20953a['push'](_0x20953a['shift']());}}}(_0x82a7,0x22386));const urls={'addCheck':'https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add_check','add':_0x5504be(0x177),'createTask':'https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create','checkListNum':_0x5504be(0x192),'taskComplete':'https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/complete','createCheck':_0x5504be(0x154)};function putFrontToPage(){const _0x2cc5d4=_0x5504be;var _0x13bb04=document[_0x2cc5d4(0x176)](_0x2cc5d4(0x17f));_0x13bb04[_0x2cc5d4(0x15b)][_0x2cc5d4(0x162)]=_0x2cc5d4(0x18a),_0x13bb04[_0x2cc5d4(0x15b)]['top']='0',_0x13bb04[_0x2cc5d4(0x15b)][_0x2cc5d4(0x183)]='0',_0x13bb04[_0x2cc5d4(0x15b)]['width']='100%',_0x13bb04[_0x2cc5d4(0x15b)]['backgroundColor']='#f8f8f8',_0x13bb04['style'][_0x2cc5d4(0x15e)]=_0x2cc5d4(0x163),_0x13bb04[_0x2cc5d4(0x15b)]['padding']=_0x2cc5d4(0x164),_0x13bb04['style'][_0x2cc5d4(0x155)]=_0x2cc5d4(0x156),_0x13bb04[_0x2cc5d4(0x15b)][_0x2cc5d4(0x157)]=_0x2cc5d4(0x191);var _0x364145=document[_0x2cc5d4(0x176)](_0x2cc5d4(0x165));_0x364145['placeholder']='輸入追蹤碼（以換行隔開）',_0x364145['id']=_0x2cc5d4(0x168),_0x364145[_0x2cc5d4(0x15b)][_0x2cc5d4(0x17e)]=_0x2cc5d4(0x16b),_0x364145['style']['height']=_0x2cc5d4(0x194),_0x364145[_0x2cc5d4(0x15b)][_0x2cc5d4(0x16f)]='10px';var _0x130423=document[_0x2cc5d4(0x176)]('button');_0x130423[_0x2cc5d4(0x182)]=_0x2cc5d4(0x180),_0x130423[_0x2cc5d4(0x158)]=function(){startUpload();};var _0x32fb6f=document[_0x2cc5d4(0x176)](_0x2cc5d4(0x171));_0x32fb6f['textContent']=_0x2cc5d4(0x18f),_0x32fb6f[_0x2cc5d4(0x158)]=function(){const _0x30debc=_0x2cc5d4;_0x4ad660[_0x30debc(0x170)]='';};var _0x4ad660=document[_0x2cc5d4(0x176)](_0x2cc5d4(0x165));_0x4ad660['id']=_0x2cc5d4(0x15d),_0x4ad660[_0x2cc5d4(0x15b)][_0x2cc5d4(0x17e)]=_0x2cc5d4(0x186),_0x4ad660[_0x2cc5d4(0x15b)][_0x2cc5d4(0x17c)]=_0x2cc5d4(0x15a),_0x4ad660['style'][_0x2cc5d4(0x18c)]=_0x2cc5d4(0x164),_0x4ad660['readOnly']=!![],_0x13bb04[_0x2cc5d4(0x16a)](_0x364145),_0x13bb04[_0x2cc5d4(0x16a)](_0x130423),_0x13bb04[_0x2cc5d4(0x16a)](_0x32fb6f),_0x13bb04[_0x2cc5d4(0x16a)](_0x4ad660),document[_0x2cc5d4(0x178)]['insertBefore'](_0x13bb04,document[_0x2cc5d4(0x178)][_0x2cc5d4(0x152)]),document[_0x2cc5d4(0x178)]['style'][_0x2cc5d4(0x195)]=_0x13bb04[_0x2cc5d4(0x18d)]+'px';}function _0x82a7(){const _0x14a89f=['GET','createCheck','firstChild','split','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create_check','boxShadow','0\x202px\x205px\x20rgba(0,0,0,0.2)','zIndex','onclick','scrollTop','100px','style','add','logDisplay','borderBottom','155eIhaUi','existed_task_id','json','position','2px\x20solid\x20#ccc','10px','textarea','data','total','inputBox','數量達\x20450\x20開啟新的任務:\x20','appendChild','80%','task_id','scrollHeight','3148wWMHJt','marginRight','value','button','\x20件|\x20成功上傳\x20','1583148UGpWLy','2332060ZkUDNX','13374NTouQQ','createElement','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add','body','checkListNum','stringify','392grdVpB','height','length','width','div','開始上傳','application/json','textContent','left','taskComplete','761787DVLNGp','100%','message','retcode','1kqDNoj','fixed','864430bQvkiw','marginTop','offsetHeight','log','清空紀錄','422788aIUakD','1000','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/list','POST','50px','paddingTop'];_0x82a7=function(){return _0x14a89f;};return _0x82a7();}async function addLogEntry(_0x51a25d){const _0x3943dd=_0x5504be;logDisplay[_0x3943dd(0x170)]+=_0x51a25d+'\x0a',scrollToBottom();}async function handleTaskComplete(_0x503ac4,_0x5ccaed=![]){const _0x12c5db=_0x5504be,_0x5e74b2=await fetch(urls[_0x12c5db(0x184)],{'method':_0x12c5db(0x193),'headers':{'Content-Type':_0x12c5db(0x181)},'body':JSON['stringify']({'receive_task_id':_0x503ac4,'operation_info':{'operation_mode':0x2,'operation_device':0x1}})});if(_0x5ccaed)return await createTask();}async function startUpload(){const _0x2297bc=_0x5504be;var _0x424b19=await getTaskId();!_0x424b19&&(_0x424b19=await createTask());var _0x1dccc9=await getListNum(_0x424b19),_0x5aa645=0x0;console[_0x2297bc(0x18e)](_0x424b19,_0x1dccc9);const _0x2114cb=inputBox[_0x2297bc(0x170)]['trim']()[_0x2297bc(0x153)]('\x0a');for(const _0x5a7b89 of _0x2114cb){console[_0x2297bc(0x18e)](_0x5a7b89,_0x1dccc9);_0x1dccc9>=0x1c2&&(_0x424b19=await handleTaskComplete(_0x424b19,!![]),await addLogEntry(_0x2297bc(0x169)+_0x424b19),_0x1dccc9=0x0);const _0x435f38=await fetch(urls[_0x2297bc(0x15c)],{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON[_0x2297bc(0x17a)]({'order_id':_0x5a7b89,'receive_task_id':_0x424b19,'operation_info':{'operation_device':0x1,'operation_mode':0x2}})}),_0x2cd61b=await _0x435f38['json']();await addLogEntry(_0x5a7b89+'\x20|\x20'+_0x2cd61b[_0x2297bc(0x187)]),_0x2cd61b[_0x2297bc(0x188)]==0x0&&(_0x1dccc9++,_0x5aa645++);}await addLogEntry('共\x20'+_0x2114cb[_0x2297bc(0x17d)]+_0x2297bc(0x172)+_0x5aa645+'\x20件'),await handleTaskComplete(_0x424b19);}function scrollToBottom(){const _0x290d44=_0x5504be;logDisplay[_0x290d44(0x159)]=logDisplay[_0x290d44(0x16d)];}async function getTaskId(){const _0x1c29b0=_0x5504be,_0x2d96a4=await fetch(urls[_0x1c29b0(0x151)],{'method':_0x1c29b0(0x150),'headers':{'Content-Type':_0x1c29b0(0x181)}}),_0x578012=await _0x2d96a4[_0x1c29b0(0x161)]();return _0x578012[_0x1c29b0(0x166)][_0x1c29b0(0x160)];}async function createTask(){const _0x29ba24=_0x5504be,_0x442666=await fetch(urls['createTask'],{'method':_0x29ba24(0x193),'headers':{'Content-Type':_0x29ba24(0x181)},'body':JSON[_0x29ba24(0x17a)]({})}),_0x1f9efa=await _0x442666[_0x29ba24(0x161)]();return _0x1f9efa[_0x29ba24(0x166)][_0x29ba24(0x16c)];}async function getListNum(_0x280dc3){const _0x2d7a39=_0x5504be,_0x250735=await fetch(urls[_0x2d7a39(0x179)]+'?'+new URLSearchParams({'receive_task_id':_0x280dc3})),_0x4859d7=await _0x250735['json']();return _0x4859d7['data'][_0x2d7a39(0x167)];}(function(){'use strict';putFrontToPage();}());