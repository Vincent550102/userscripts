// ==UserScript==
// @name         shopee 追蹤碼上傳
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  自動上傳追蹤碼到 shopee 內部系統
// @author       Vincent55
// @match        https://sp.spx.shopee.tw/inbound-management*
// @grant        none
// ==/UserScript==

const _0x3f5110=_0x58bb;(function(_0x36b630,_0xafbf88){const _0x8dd635=_0x58bb,_0x473938=_0x36b630();while(!![]){try{const _0x546a95=-parseInt(_0x8dd635(0x73))/0x1+-parseInt(_0x8dd635(0xa3))/0x2+parseInt(_0x8dd635(0x6f))/0x3+-parseInt(_0x8dd635(0x7a))/0x4+parseInt(_0x8dd635(0x9c))/0x5+parseInt(_0x8dd635(0xa8))/0x6+parseInt(_0x8dd635(0x97))/0x7*(parseInt(_0x8dd635(0x76))/0x8);if(_0x546a95===_0xafbf88)break;else _0x473938['push'](_0x473938['shift']());}catch(_0x33fdfe){_0x473938['push'](_0x473938['shift']());}}}(_0x806a,0x900e1));function _0x806a(){const _0x328d8f=['textContent','onclick','left','GET','trim','appendChild','total','style','POST','100%','marginTop','width','borderBottom','max','scrollHeight','createElement','logDisplay','開始上傳','476PmLJZq','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/list','padding','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create_check','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create','2708460DWJcdL','fromCharCode','請輸入\x20token','fixed','100px','height','split','72828ksvfHH','data','existed_task_id','retcode','button','5389686TVOTIS','boxShadow','createTask','stringify','#f8f8f8','text','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add','application/json','token\x20錯誤','50px','position','Invalid','清空紀錄','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add_check','0\x202px\x205px\x20rgba(0,0,0,0.2)','top','2px\x20solid\x20#ccc','firstChild','length','add','\x20件|\x20成功上傳\x20','408084qzGtGa','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/complete','insertBefore','10px','238900vDRbgL','charCodeAt','taskComplete','2168sghSiZ','value','1000','https://dev.orglife.com.tw/Api/DB?Type=Token&App=ShopeeUpload&Token=','2916264vOKlcC','placeholder','textarea','log','backgroundColor','scrollTop','readOnly','message','數量達\x20450\x20開啟新的任務:\x20','json','body'];_0x806a=function(){return _0x328d8f;};return _0x806a();}const urls={'addCheck':_0x3f5110(0xb5),'add':_0x3f5110(0xae),'createTask':_0x3f5110(0x9b),'checkListNum':_0x3f5110(0x98),'taskComplete':_0x3f5110(0x70),'createCheck':_0x3f5110(0x9a)};async function putFrontToPage(){const _0x709b25=_0x3f5110;var _0x1a70c3=document[_0x709b25(0x94)]('div');_0x1a70c3[_0x709b25(0x8c)][_0x709b25(0xb2)]=_0x709b25(0x9f),_0x1a70c3['style'][_0x709b25(0x69)]='0',_0x1a70c3[_0x709b25(0x8c)][_0x709b25(0x87)]='0',_0x1a70c3[_0x709b25(0x8c)]['width']='100%',_0x1a70c3[_0x709b25(0x8c)][_0x709b25(0x7e)]=_0x709b25(0xac),_0x1a70c3[_0x709b25(0x8c)][_0x709b25(0x91)]=_0x709b25(0x6a),_0x1a70c3[_0x709b25(0x8c)][_0x709b25(0x99)]='10px',_0x1a70c3[_0x709b25(0x8c)][_0x709b25(0xa9)]=_0x709b25(0xb6),_0x1a70c3['style']['zIndex']=_0x709b25(0x78);var _0x2dfc62=document[_0x709b25(0x94)](_0x709b25(0x7c));_0x2dfc62[_0x709b25(0x7b)]='輸入追蹤碼（以換行隔開）',_0x2dfc62['id']='inputBox',_0x2dfc62['style'][_0x709b25(0x90)]='80%',_0x2dfc62[_0x709b25(0x8c)][_0x709b25(0xa1)]=_0x709b25(0xb1),_0x2dfc62[_0x709b25(0x8c)]['marginRight']=_0x709b25(0x72);var _0x331fa7=document[_0x709b25(0x94)]('button');_0x331fa7[_0x709b25(0x85)]=_0x709b25(0x96),_0x331fa7[_0x709b25(0x86)]=function(){startUpload();};var _0x2e996c=document['createElement'](_0x709b25(0xa7));_0x2e996c[_0x709b25(0x85)]=_0x709b25(0xb4),_0x2e996c[_0x709b25(0x86)]=function(){const _0x4b745b=_0x709b25;_0x1875c2[_0x4b745b(0x77)]='';};var _0x1875c2=document[_0x709b25(0x94)]('textarea');_0x1875c2['id']=_0x709b25(0x95),_0x1875c2[_0x709b25(0x8c)][_0x709b25(0x90)]=_0x709b25(0x8e),_0x1875c2[_0x709b25(0x8c)]['height']=_0x709b25(0xa0),_0x1875c2['style'][_0x709b25(0x8f)]=_0x709b25(0x72),_0x1875c2[_0x709b25(0x80)]=!![],_0x1a70c3[_0x709b25(0x8a)](_0x2dfc62),_0x1a70c3[_0x709b25(0x8a)](_0x331fa7),_0x1a70c3['appendChild'](_0x2e996c),_0x1a70c3[_0x709b25(0x8a)](_0x1875c2),document['body'][_0x709b25(0x71)](_0x1a70c3,document[_0x709b25(0x84)][_0x709b25(0x6b)]),document[_0x709b25(0x84)][_0x709b25(0x8c)]['paddingTop']=_0x1a70c3['offsetHeight']+'px';}async function addLogEntry(_0x4326eb){logDisplay['value']+=_0x4326eb+'\x0a',scrollToBottom();}async function handleTaskComplete(_0x37bce1,_0x5d516d=![]){const _0xc089ec=_0x3f5110,_0x405081=await fetch(urls[_0xc089ec(0x75)],{'method':_0xc089ec(0x8d),'headers':{'Content-Type':_0xc089ec(0xaf)},'body':JSON['stringify']({'receive_task_id':_0x37bce1,'operation_info':{'operation_mode':0x2,'operation_device':0x1}})});if(_0x5d516d)return await createTask();}async function startUpload(){const _0x47ca67=_0x3f5110;var _0x501423=await getTaskId();!_0x501423&&(_0x501423=await createTask());var _0x5793df=await getListNum(_0x501423),_0x16562f=0x0;console['log'](_0x501423,_0x5793df);const _0x5a4413=inputBox[_0x47ca67(0x77)][_0x47ca67(0x89)]()[_0x47ca67(0xa2)]('\x0a');for(const _0x4d7515 of _0x5a4413){console[_0x47ca67(0x7d)](_0x4d7515,_0x5793df);_0x5793df>=0x1c2&&(_0x501423=await handleTaskComplete(_0x501423,!![]),await addLogEntry(_0x47ca67(0x82)+_0x501423),_0x5793df=0x0);const _0x13f6bb=await fetch(urls[_0x47ca67(0x6d)],{'method':_0x47ca67(0x8d),'headers':{'Content-Type':_0x47ca67(0xaf)},'body':JSON['stringify']({'order_id':_0x4d7515,'receive_task_id':_0x501423,'operation_info':{'operation_device':0x1,'operation_mode':0x2}})}),_0x16280a=await _0x13f6bb[_0x47ca67(0x83)]();await addLogEntry(_0x4d7515+'\x20|\x20'+_0x16280a[_0x47ca67(0x81)]),_0x16280a[_0x47ca67(0xa6)]==0x0&&(_0x5793df++,_0x16562f++);}await addLogEntry('共\x20'+_0x5a4413['length']+_0x47ca67(0x6e)+_0x16562f+'\x20件'),await handleTaskComplete(_0x501423);}function _0x58bb(_0x462cb4,_0x499f5c){const _0x806a97=_0x806a();return _0x58bb=function(_0x58bb2c,_0x4d99a6){_0x58bb2c=_0x58bb2c-0x69;let _0x1d2719=_0x806a97[_0x58bb2c];return _0x1d2719;},_0x58bb(_0x462cb4,_0x499f5c);}function scrollToBottom(){const _0x51b89d=_0x3f5110;logDisplay[_0x51b89d(0x7f)]=logDisplay[_0x51b89d(0x93)];}async function getTaskId(){const _0x478294=_0x3f5110,_0xbd43bb=await fetch(urls['createCheck'],{'method':_0x478294(0x88),'headers':{'Content-Type':_0x478294(0xaf)}}),_0x30bdfb=await _0xbd43bb[_0x478294(0x83)]();return _0x30bdfb['data'][_0x478294(0xa5)];}async function createTask(){const _0x1575f7=_0x3f5110,_0x2bf049=await fetch(urls[_0x1575f7(0xaa)],{'method':'POST','headers':{'Content-Type':_0x1575f7(0xaf)},'body':JSON[_0x1575f7(0xab)]({})}),_0x3d9819=await _0x2bf049['json']();return _0x3d9819['data']['task_id'];}async function getListNum(_0x3ac286){const _0x47a3b2=_0x3f5110,_0x3f7b45=await fetch(urls['checkListNum']+'?'+new URLSearchParams({'receive_task_id':_0x3ac286})),_0x4225a7=await _0x3f7b45['json']();return _0x4225a7[_0x47a3b2(0xa4)][_0x47a3b2(0x8b)];}function xorStrings(_0x54b5b8,_0x37cc05){const _0x4a4d0e=_0x3f5110;let _0x45b915='',_0x1deeb2=Math[_0x4a4d0e(0x92)](_0x54b5b8[_0x4a4d0e(0x6c)],_0x37cc05['length']);for(let _0x3e3200=0x0;_0x3e3200<_0x1deeb2;_0x3e3200++){let _0x6717c4=_0x54b5b8['charCodeAt'](_0x3e3200%_0x54b5b8[_0x4a4d0e(0x6c)]),_0x2a2394=_0x37cc05[_0x4a4d0e(0x74)](_0x3e3200%_0x37cc05[_0x4a4d0e(0x6c)]);_0x45b915+=String[_0x4a4d0e(0x9d)](_0x6717c4^_0x2a2394);}return btoa(_0x45b915);}(async function(){'use strict';const _0x313c06=_0x3f5110;const _0xbc57bb=prompt(_0x313c06(0x9e)),_0x55ea99=_0x313c06(0x79),_0x271fac=await fetch(_0x55ea99+_0xbc57bb),_0x41cf40=await _0x271fac[_0x313c06(0xad)]();if(!_0x41cf40['includes'](_0x313c06(0xb3)))await putFrontToPage();else alert(_0x313c06(0xb0));}());