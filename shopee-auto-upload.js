// ==UserScript==
// @name         shopee 追蹤碼上傳
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  自動上傳追蹤碼到 shopee 內部系統
// @author       Vincent55
// @match        https://sp.spx.shopee.tw/inbound-management*
// @grant        none
// ==/UserScript==

const _0x5593d1=_0x45c2;(function(_0x58fcdb,_0x2ef12a){const _0x511583=_0x45c2,_0x559f92=_0x58fcdb();while(!![]){try{const _0x16f153=-parseInt(_0x511583(0x1f6))/0x1*(-parseInt(_0x511583(0x21c))/0x2)+parseInt(_0x511583(0x202))/0x3+parseInt(_0x511583(0x1f5))/0x4*(parseInt(_0x511583(0x20f))/0x5)+-parseInt(_0x511583(0x206))/0x6*(-parseInt(_0x511583(0x23d))/0x7)+-parseInt(_0x511583(0x1f7))/0x8*(-parseInt(_0x511583(0x222))/0x9)+parseInt(_0x511583(0x22a))/0xa*(parseInt(_0x511583(0x21f))/0xb)+-parseInt(_0x511583(0x239))/0xc*(parseInt(_0x511583(0x1ff))/0xd);if(_0x16f153===_0x2ef12a)break;else _0x559f92['push'](_0x559f92['shift']());}catch(_0x83cef0){_0x559f92['push'](_0x559f92['shift']());}}}(_0x6731,0x99712));const urls={'addCheck':_0x5593d1(0x212),'add':_0x5593d1(0x236),'createTask':_0x5593d1(0x22d),'checkListNum':_0x5593d1(0x227),'taskComplete':_0x5593d1(0x240),'createCheck':_0x5593d1(0x214)},passwords=['RAIhAC8HQj8=',_0x5593d1(0x20a),_0x5593d1(0x1eb),_0x5593d1(0x205),_0x5593d1(0x204),_0x5593d1(0x23b),_0x5593d1(0x208),_0x5593d1(0x1ee),'KUIFJUM8Bjs=',_0x5593d1(0x1ea)];function putFrontToPage(){const _0x124d9f=_0x5593d1;var _0x554454=document[_0x124d9f(0x203)](_0x124d9f(0x21b));_0x554454[_0x124d9f(0x1fc)][_0x124d9f(0x237)]='fixed',_0x554454[_0x124d9f(0x1fc)][_0x124d9f(0x220)]='0',_0x554454[_0x124d9f(0x1fc)][_0x124d9f(0x223)]='0',_0x554454[_0x124d9f(0x1fc)]['width']='100%',_0x554454[_0x124d9f(0x1fc)]['backgroundColor']='#f8f8f8',_0x554454['style'][_0x124d9f(0x228)]='2px\x20solid\x20#ccc',_0x554454['style'][_0x124d9f(0x1f8)]='10px',_0x554454[_0x124d9f(0x1fc)]['boxShadow']='0\x202px\x205px\x20rgba(0,0,0,0.2)',_0x554454[_0x124d9f(0x1fc)][_0x124d9f(0x1f9)]=_0x124d9f(0x22c);var _0x20180a=document[_0x124d9f(0x203)]('textarea');_0x20180a[_0x124d9f(0x226)]=_0x124d9f(0x20d),_0x20180a['id']=_0x124d9f(0x209),_0x20180a[_0x124d9f(0x1fc)][_0x124d9f(0x1f0)]=_0x124d9f(0x210),_0x20180a[_0x124d9f(0x1fc)][_0x124d9f(0x1ef)]='50px',_0x20180a[_0x124d9f(0x1fc)][_0x124d9f(0x23e)]='10px';var _0x2d01da=document[_0x124d9f(0x203)](_0x124d9f(0x21d));_0x2d01da[_0x124d9f(0x231)]=_0x124d9f(0x1f4),_0x2d01da[_0x124d9f(0x22e)]=function(){startUpload();};var _0xb56a31=document[_0x124d9f(0x203)](_0x124d9f(0x21d));_0xb56a31[_0x124d9f(0x231)]=_0x124d9f(0x23a),_0xb56a31[_0x124d9f(0x22e)]=function(){const _0x3ea212=_0x124d9f;_0x232627[_0x3ea212(0x233)]='';};var _0x232627=document['createElement'](_0x124d9f(0x20b));_0x232627['id']=_0x124d9f(0x213),_0x232627['style'][_0x124d9f(0x1f0)]=_0x124d9f(0x218),_0x232627[_0x124d9f(0x1fc)]['height']=_0x124d9f(0x235),_0x232627[_0x124d9f(0x1fc)]['marginTop']=_0x124d9f(0x22b),_0x232627[_0x124d9f(0x20c)]=!![],_0x554454[_0x124d9f(0x1f2)](_0x20180a),_0x554454[_0x124d9f(0x1f2)](_0x2d01da),_0x554454[_0x124d9f(0x1f2)](_0xb56a31),_0x554454['appendChild'](_0x232627),document['body'][_0x124d9f(0x225)](_0x554454,document[_0x124d9f(0x22f)]['firstChild']),document[_0x124d9f(0x22f)]['style'][_0x124d9f(0x1fb)]=_0x554454[_0x124d9f(0x224)]+'px';}async function addLogEntry(_0x457116){const _0x3250c8=_0x5593d1;logDisplay[_0x3250c8(0x233)]+=_0x457116+'\x0a',scrollToBottom();}async function handleTaskComplete(_0x2ea6e5,_0x34e045=![]){const _0x326662=_0x5593d1,_0x1658cf=await fetch(urls['taskComplete'],{'method':'POST','headers':{'Content-Type':_0x326662(0x229)},'body':JSON['stringify']({'receive_task_id':_0x2ea6e5,'operation_info':{'operation_mode':0x2,'operation_device':0x1}})});if(_0x34e045)return await createTask();}function _0x45c2(_0x5dd4f2,_0x12e96f){const _0x6731c2=_0x6731();return _0x45c2=function(_0x45c25e,_0x522398){_0x45c25e=_0x45c25e-0x1ea;let _0x1d6b59=_0x6731c2[_0x45c25e];return _0x1d6b59;},_0x45c2(_0x5dd4f2,_0x12e96f);}function _0x6731(){const _0x3f75e5=['textContent','data','value','qwq','100px','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add','position','json','9852SqFuCh','清空紀錄','N0AaPEY/BiM=','stringify','4366383hYQZpL','marginRight','scrollHeight','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/complete','NUEHIE4cMhk=','MEU9BE82Cy4=','GET','createCheck','J0MbIEEhHwA=','height','width','max','appendChild','密碼錯誤','開始上傳','12OLxRRL','145Lgrndg','15584DPsSqM','padding','zIndex','log','paddingTop','style','scrollTop','數量達\x20450\x20開啟新的任務:\x20','56563Miohku','length','retcode','2203662TZwEvT','createElement','IUIWPUMDKx0=','PE8DJQ8mB0M=','6yPKnRD','\x20|\x20','BTsLSTpENh0=','inputBox','ACEbNEAjHCA=','textarea','readOnly','輸入追蹤碼（以換行隔開）','POST','1403125crQxpe','80%','charCodeAt','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add_check','logDisplay','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create_check','total','createTask','請輸入密碼','100%','task_id','checkListNum','div','9106DfDEpt','button','message','22gaPDYW','top','split','2133jtqFmY','left','offsetHeight','insertBefore','placeholder','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/list','borderBottom','application/json','4393050VPleUh','10px','1000','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create','onclick','body','trim'];_0x6731=function(){return _0x3f75e5;};return _0x6731();}async function startUpload(){const _0x329c05=_0x5593d1;var _0x10b4d3=await getTaskId();!_0x10b4d3&&(_0x10b4d3=await createTask());var _0x50831a=await getListNum(_0x10b4d3),_0x23fae3=0x0;console[_0x329c05(0x1fa)](_0x10b4d3,_0x50831a);const _0x293b5e=inputBox[_0x329c05(0x233)][_0x329c05(0x230)]()[_0x329c05(0x221)]('\x0a');for(const _0x33ac1f of _0x293b5e){console['log'](_0x33ac1f,_0x50831a);_0x50831a>=0x1c2&&(_0x10b4d3=await handleTaskComplete(_0x10b4d3,!![]),await addLogEntry(_0x329c05(0x1fe)+_0x10b4d3),_0x50831a=0x0);const _0x27dcf8=await fetch(urls['add'],{'method':_0x329c05(0x20e),'headers':{'Content-Type':'application/json'},'body':JSON[_0x329c05(0x23c)]({'order_id':_0x33ac1f,'receive_task_id':_0x10b4d3,'operation_info':{'operation_device':0x1,'operation_mode':0x2}})}),_0x4c599e=await _0x27dcf8[_0x329c05(0x238)]();await addLogEntry(_0x33ac1f+_0x329c05(0x207)+_0x4c599e[_0x329c05(0x21e)]),_0x4c599e[_0x329c05(0x201)]==0x0&&(_0x50831a++,_0x23fae3++);}await addLogEntry('共\x20'+_0x293b5e[_0x329c05(0x200)]+'\x20件|\x20成功上傳\x20'+_0x23fae3+'\x20件'),await handleTaskComplete(_0x10b4d3);}function scrollToBottom(){const _0x1c29c0=_0x5593d1;logDisplay[_0x1c29c0(0x1fd)]=logDisplay[_0x1c29c0(0x23f)];}async function getTaskId(){const _0x117dfb=_0x5593d1,_0x5e176f=await fetch(urls[_0x117dfb(0x1ed)],{'method':_0x117dfb(0x1ec),'headers':{'Content-Type':_0x117dfb(0x229)}}),_0x4f63cd=await _0x5e176f[_0x117dfb(0x238)]();return _0x4f63cd[_0x117dfb(0x232)]['existed_task_id'];}async function createTask(){const _0x1e3384=_0x5593d1,_0x5acc75=await fetch(urls[_0x1e3384(0x216)],{'method':'POST','headers':{'Content-Type':_0x1e3384(0x229)},'body':JSON[_0x1e3384(0x23c)]({})}),_0x2f4f6a=await _0x5acc75[_0x1e3384(0x238)]();return _0x2f4f6a[_0x1e3384(0x232)][_0x1e3384(0x219)];}async function getListNum(_0x2ebba5){const _0x95cb83=_0x5593d1,_0x28a111=await fetch(urls[_0x95cb83(0x21a)]+'?'+new URLSearchParams({'receive_task_id':_0x2ebba5})),_0x8b9345=await _0x28a111['json']();return _0x8b9345[_0x95cb83(0x232)][_0x95cb83(0x215)];}function xorStrings(_0x9753bf,_0x16ff26){const _0x305b9a=_0x5593d1;let _0xb81483='',_0x17e528=Math[_0x305b9a(0x1f1)](_0x9753bf[_0x305b9a(0x200)],_0x16ff26[_0x305b9a(0x200)]);for(let _0x3b7ed7=0x0;_0x3b7ed7<_0x17e528;_0x3b7ed7++){let _0x491a6a=_0x9753bf[_0x305b9a(0x211)](_0x3b7ed7%_0x9753bf[_0x305b9a(0x200)]),_0x66831c=_0x16ff26[_0x305b9a(0x211)](_0x3b7ed7%_0x16ff26['length']);_0xb81483+=String['fromCharCode'](_0x491a6a^_0x66831c);}return btoa(_0xb81483);}(function(){'use strict';const _0x5974ac=_0x5593d1;const _0x2fdf55=prompt(_0x5974ac(0x217));var _0x1586c9=0x1;for(const _0x249bea of passwords){if(atob(xorStrings(atob(_0x249bea),_0x5974ac(0x234)))==_0x2fdf55){putFrontToPage(),_0x1586c9=0x0;break;}}if(_0x1586c9)alert(_0x5974ac(0x1f3));}());