// ==UserScript==
// @name         shopee 追蹤碼上傳
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  自動上傳追蹤碼到 shopee 內部系統
// @author       Vincent55
// @match        https://sp.spx.shopee.tw/inbound-management*
// @grant        none
// ==/UserScript==

const _0x2348a7=_0x8ae2;(function(_0x2b1887,_0xbc9ed7){const _0x379309=_0x8ae2,_0x21ce27=_0x2b1887();while(!![]){try{const _0x3da654=-parseInt(_0x379309(0x11e))/0x1*(-parseInt(_0x379309(0x12a))/0x2)+parseInt(_0x379309(0x12e))/0x3+-parseInt(_0x379309(0x110))/0x4*(-parseInt(_0x379309(0x124))/0x5)+parseInt(_0x379309(0x10e))/0x6+parseInt(_0x379309(0x143))/0x7*(-parseInt(_0x379309(0x10f))/0x8)+-parseInt(_0x379309(0x116))/0x9*(-parseInt(_0x379309(0x13b))/0xa)+parseInt(_0x379309(0x126))/0xb*(-parseInt(_0x379309(0x153))/0xc);if(_0x3da654===_0xbc9ed7)break;else _0x21ce27['push'](_0x21ce27['shift']());}catch(_0x20bfea){_0x21ce27['push'](_0x21ce27['shift']());}}}(_0x44be,0x72a85));const urls={'addCheck':_0x2348a7(0x14d),'add':_0x2348a7(0x148),'createTask':_0x2348a7(0x12f),'checkListNum':_0x2348a7(0x150),'taskComplete':_0x2348a7(0x14c),'createCheck':_0x2348a7(0x12c)};function _0x8ae2(_0x34c5cd,_0x45a2a4){const _0x44befb=_0x44be();return _0x8ae2=function(_0x8ae234,_0x371463){_0x8ae234=_0x8ae234-0x109;let _0x114733=_0x44befb[_0x8ae234];return _0x114733;},_0x8ae2(_0x34c5cd,_0x45a2a4);}async function putFrontToPage(){const _0x4339c9=_0x2348a7;var _0x59bed3=document['createElement'](_0x4339c9(0x123));_0x59bed3[_0x4339c9(0x13d)][_0x4339c9(0x138)]=_0x4339c9(0x157),_0x59bed3[_0x4339c9(0x13d)]['top']='0',_0x59bed3['style'][_0x4339c9(0x119)]='0',_0x59bed3[_0x4339c9(0x13d)][_0x4339c9(0x152)]=_0x4339c9(0x15b),_0x59bed3[_0x4339c9(0x13d)]['backgroundColor']=_0x4339c9(0x154),_0x59bed3[_0x4339c9(0x13d)][_0x4339c9(0x114)]=_0x4339c9(0x11f),_0x59bed3[_0x4339c9(0x13d)][_0x4339c9(0x12b)]='10px',_0x59bed3[_0x4339c9(0x13d)][_0x4339c9(0x15d)]='0\x202px\x205px\x20rgba(0,0,0,0.2)',_0x59bed3[_0x4339c9(0x13d)][_0x4339c9(0x136)]=_0x4339c9(0x10d);var _0x4625a4=document[_0x4339c9(0x127)](_0x4339c9(0x137));_0x4625a4['placeholder']='輸入追蹤碼（以換行隔開）',_0x4625a4['id']='inputBox',_0x4625a4[_0x4339c9(0x13d)][_0x4339c9(0x152)]=_0x4339c9(0x14b),_0x4625a4[_0x4339c9(0x13d)][_0x4339c9(0x121)]=_0x4339c9(0x149),_0x4625a4[_0x4339c9(0x13d)]['marginRight']='10px';var _0x344c1a=document['createElement'](_0x4339c9(0x158));_0x344c1a[_0x4339c9(0x113)]=_0x4339c9(0x15a),_0x344c1a[_0x4339c9(0x15c)]=function(){startUpload();};var _0xd49288=document[_0x4339c9(0x127)](_0x4339c9(0x158));_0xd49288[_0x4339c9(0x113)]=_0x4339c9(0x13c),_0xd49288[_0x4339c9(0x15c)]=function(){const _0x4134c5=_0x4339c9;_0xff8ff9[_0x4134c5(0x140)]='';};var _0xff8ff9=document['createElement'](_0x4339c9(0x137));_0xff8ff9['id']='logDisplay',_0xff8ff9[_0x4339c9(0x13d)][_0x4339c9(0x152)]='100%',_0xff8ff9[_0x4339c9(0x13d)]['height']=_0x4339c9(0x139),_0xff8ff9['style'][_0x4339c9(0x13f)]=_0x4339c9(0x118),_0xff8ff9[_0x4339c9(0x135)]=!![],_0x59bed3[_0x4339c9(0x129)](_0x4625a4),_0x59bed3[_0x4339c9(0x129)](_0x344c1a),_0x59bed3[_0x4339c9(0x129)](_0xd49288),_0x59bed3['appendChild'](_0xff8ff9),document[_0x4339c9(0x131)][_0x4339c9(0x11d)](_0x59bed3,document[_0x4339c9(0x131)]['firstChild']),document[_0x4339c9(0x131)]['style'][_0x4339c9(0x11b)]=_0x59bed3[_0x4339c9(0x13e)]+'px';}async function addLogEntry(_0x1adc0f){const _0x2e5e80=_0x2348a7;logDisplay[_0x2e5e80(0x140)]+=_0x1adc0f+'\x0a',scrollToBottom();}async function handleTaskComplete(_0x55df62,_0x406025=![]){const _0xc50048=_0x2348a7,_0x54016e=await fetch(urls[_0xc50048(0x130)],{'method':'POST','headers':{'Content-Type':_0xc50048(0x10a)},'body':JSON['stringify']({'receive_task_id':_0x55df62,'operation_info':{'operation_mode':0x2,'operation_device':0x1}})});if(_0x406025)return await createTask();}async function startUpload(){const _0x5f47f1=_0x2348a7;var _0x4e07f5=await getTaskId();!_0x4e07f5&&(_0x4e07f5=await createTask());var _0x18bc7f=await getListNum(_0x4e07f5),_0x2ea3e1=0x0;console['log'](_0x4e07f5,_0x18bc7f);const _0x4e4bd3=inputBox[_0x5f47f1(0x140)][_0x5f47f1(0x147)]()[_0x5f47f1(0x145)]('\x0a');for(const _0x499085 of _0x4e4bd3){console['log'](_0x499085,_0x18bc7f);_0x18bc7f>=0x1c2&&(_0x4e07f5=await handleTaskComplete(_0x4e07f5,!![]),await addLogEntry('數量達\x20450\x20開啟新的任務:\x20'+_0x4e07f5),_0x18bc7f=0x0);const _0x5cadd5=await fetch(urls[_0x5f47f1(0x151)],{'method':_0x5f47f1(0x109),'headers':{'Content-Type':_0x5f47f1(0x10a)},'body':JSON[_0x5f47f1(0x111)]({'order_id':_0x499085,'receive_task_id':_0x4e07f5,'operation_info':{'operation_device':0x1,'operation_mode':0x2}})}),_0xa4e5c1=await _0x5cadd5['json']();await addLogEntry(_0x499085+_0x5f47f1(0x120)+_0xa4e5c1[_0x5f47f1(0x142)]),_0xa4e5c1[_0x5f47f1(0x13a)]==0x0&&(_0x18bc7f++,_0x2ea3e1++);}await addLogEntry('共\x20'+_0x4e4bd3[_0x5f47f1(0x146)]+_0x5f47f1(0x141)+_0x2ea3e1+'\x20件'),await handleTaskComplete(_0x4e07f5);}function _0x44be(){const _0x31ed13=['length','trim','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add','50px','Invalid','80%','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/complete','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/add_check','location','charCodeAt','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/order/list','add','width','26712VmuvGe','#f8f8f8','get','token','fixed','button','createCheck','開始上傳','100%','onclick','boxShadow','POST','application/json','log','total','1000','3713784VCfAJZ','5325808EPZSId','13460JHkVMu','stringify','scrollHeight','textContent','borderBottom','data','126tmbMJx','scrollTop','10px','left','https://dev.orglife.com.tw/Api/DB?Type=Token&App=ShopeeUpload&Token=','paddingTop','search','insertBefore','24047QJgMFj','2px\x20solid\x20#ccc','\x20|\x20','height','text','div','620ucYORw','createTask','8657qqramN','createElement','json','appendChild','78TTAPzc','padding','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create_check','token\x20未給予','2127774KGxTPO','https://sp.spx.shopee.tw/sp-api/point/dop/receive_task/create','taskComplete','body','existed_task_id','token\x20錯誤','Name:\x20','readOnly','zIndex','textarea','position','100px','retcode','145650yewdjI','清空紀錄','style','offsetHeight','marginTop','value','\x20件|\x20成功上傳\x20','message','7jNxcIQ','max','split'];_0x44be=function(){return _0x31ed13;};return _0x44be();}function scrollToBottom(){const _0x3db991=_0x2348a7;logDisplay[_0x3db991(0x117)]=logDisplay[_0x3db991(0x112)];}async function getTaskId(){const _0x238800=_0x2348a7,_0x38d82f=await fetch(urls[_0x238800(0x159)],{'method':'GET','headers':{'Content-Type':_0x238800(0x10a)}}),_0x5f302e=await _0x38d82f[_0x238800(0x128)]();return _0x5f302e[_0x238800(0x115)][_0x238800(0x132)];}async function createTask(){const _0x41e582=_0x2348a7,_0x467753=await fetch(urls[_0x41e582(0x125)],{'method':_0x41e582(0x109),'headers':{'Content-Type':_0x41e582(0x10a)},'body':JSON[_0x41e582(0x111)]({})}),_0x578cdf=await _0x467753[_0x41e582(0x128)]();return _0x578cdf['data']['task_id'];}async function getListNum(_0x5c1c54){const _0x45b1bf=_0x2348a7,_0x12ce17=await fetch(urls['checkListNum']+'?'+new URLSearchParams({'receive_task_id':_0x5c1c54})),_0x12d89c=await _0x12ce17[_0x45b1bf(0x128)]();return _0x12d89c[_0x45b1bf(0x115)][_0x45b1bf(0x10c)];}function xorStrings(_0x5d0e95,_0x26efa0){const _0x1a7155=_0x2348a7;let _0x29cb4a='',_0x53b670=Math[_0x1a7155(0x144)](_0x5d0e95[_0x1a7155(0x146)],_0x26efa0[_0x1a7155(0x146)]);for(let _0x4a3fed=0x0;_0x4a3fed<_0x53b670;_0x4a3fed++){let _0x3e4fb7=_0x5d0e95[_0x1a7155(0x14f)](_0x4a3fed%_0x5d0e95[_0x1a7155(0x146)]),_0x37a48b=_0x26efa0[_0x1a7155(0x14f)](_0x4a3fed%_0x26efa0[_0x1a7155(0x146)]);_0x29cb4a+=String['fromCharCode'](_0x3e4fb7^_0x37a48b);}return btoa(_0x29cb4a);}(async function(){'use strict';const _0x60b09=_0x2348a7;const _0x1ac723=new URLSearchParams(window[_0x60b09(0x14e)][_0x60b09(0x11c)]),_0x22cd73=_0x1ac723[_0x60b09(0x155)](_0x60b09(0x156));if(!_0x22cd73){alert(_0x60b09(0x12d));return;}console[_0x60b09(0x10b)](_0x60b09(0x134)+_0x22cd73);const _0x529883=_0x60b09(0x11a),_0x170481=await fetch(_0x529883+_0x22cd73),_0x52bc22=await _0x170481[_0x60b09(0x122)]();if(!_0x52bc22['includes'](_0x60b09(0x14a)))await putFrontToPage();else alert(_0x60b09(0x133));}());